2025-04-24 10:51:00 - INFO - Logging initialized. Log file: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/logs/asv_selection_20250424_105100.log
2025-04-24 10:51:00 - INFO - Starting ASV Selection Analysis...
2025-04-24 10:51:00 - INFO - Copying file to temporary location: /var/folders/5b/1yjp54491txfqjty7rqyyyww0000gn/T/tmp0gipt6v5/input_data.csv
2025-04-24 10:51:00 - INFO - Reading data from temporary file
2025-04-24 10:51:01 - INFO - Successfully loaded 63451 records
2025-04-24 10:51:01 - INFO - Starting data preprocessing...
2025-04-24 10:51:01 - INFO - Training Random Forest model...
2025-04-24 10:51:32 - INFO - 
Model Training Results:
2025-04-24 10:51:32 - INFO - Best parameters: {'class_weight': 'balanced', 'max_depth': None, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 300}
2025-04-24 10:51:32 - INFO - Cross-validation score: 0.9674
2025-04-24 10:51:32 - INFO - Test accuracy: 0.9980
2025-04-24 10:51:32 - INFO - 
Finding optimal threshold...
2025-04-24 10:51:32 - INFO - Performing coarse threshold search...
2025-04-24 10:51:33 - INFO - Performing medium-grain threshold search...
2025-04-24 10:51:34 - INFO - Performing fine-grain threshold search...
2025-04-24 10:51:35 - INFO - Optimal threshold found: 0.3300
2025-04-24 10:51:35 - INFO - 
Saving model components...
2025-04-24 10:51:35 - INFO - Saved model to: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/trained_model.joblib
2025-04-24 10:51:35 - INFO - Saved scaler to: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/scaler.joblib
2025-04-24 10:51:35 - INFO - Saved configuration to: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/model_config.json
2025-04-24 10:51:35 - INFO - 
Applying model predictions with threshold 0.3300
2025-04-24 10:52:00 - INFO - 
Prediction Statistics:
2025-04-24 10:52:00 - INFO - Total samples processed: 10395
2025-04-24 10:52:00 - INFO - Total ASVs selected: 8559
2025-04-24 10:52:00 - INFO - Agreement rate: 1.0000
2025-04-24 10:52:00 - INFO - ASV Selection Summary - Total: 63451, Selected: 8559, Rate: 13.49%
2025-04-24 10:52:00 - INFO - 
Analyzing features...
2025-04-24 10:52:00 - INFO - Using threshold 0.33 for feature analysis
2025-04-24 10:52:01 - INFO - Creating feature plots with threshold: 0.33
2025-04-24 10:52:01 - INFO - Using threshold 0.33 in feature plots
2025-04-24 10:52:01 - INFO - Feature analysis complete!
2025-04-24 10:52:15 - INFO - Saved results to CSV: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/analysis_results.csv
2025-04-24 10:52:16 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/pca_analysis/pca_analysis.html
2025-04-24 10:52:17 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/pca_analysis/pca_analysis.json
2025-04-24 10:52:17 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_reads.html
2025-04-24 10:52:17 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_reads.json
2025-04-24 10:52:17 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_total_asv_reads.html
2025-04-24 10:52:17 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_total_asv_reads.json
2025-04-24 10:52:17 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_asv_count.html
2025-04-24 10:52:17 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_asv_count.json
2025-04-24 10:52:17 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_percentage_reads.html
2025-04-24 10:52:17 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_percentage_reads.json
2025-04-24 10:52:17 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_read_proportion.html
2025-04-24 10:52:17 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_read_proportion.json
2025-04-24 10:52:17 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_log_reads.html
2025-04-24 10:52:18 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_log_reads.json
2025-04-24 10:52:18 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_read_density.html
2025-04-24 10:52:18 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_read_density.json
2025-04-24 10:52:18 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_is_single_asv.html
2025-04-24 10:52:18 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_is_single_asv.json
2025-04-24 10:52:18 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_is_dominant_asv.html
2025-04-24 10:52:18 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_is_dominant_asv.json
2025-04-24 10:52:18 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_reads_rank.html
2025-04-24 10:52:18 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_reads_rank.json
2025-04-24 10:52:18 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_relative_abundance.html
2025-04-24 10:52:18 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_relative_abundance.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_is_match.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/feature_analysis/feature_distribution_is_match.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/model_performance/feature_importance.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/model_performance/feature_importance.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/model_performance/roc_curve.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/model_performance/roc_curve.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/model_performance/confusion_matrix.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/model_performance/confusion_matrix.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/correlation_analysis/correlation_matrix.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/correlation_analysis/correlation_matrix.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/correlation_analysis/feature_dendrogram.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/correlation_analysis/feature_dendrogram.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/threshold_analysis/threshold_optimization.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/threshold_analysis/threshold_optimization.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/agreement_analysis/agreement_distribution.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/agreement_analysis/agreement_distribution.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/agreement_analysis/decision_matrix.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/agreement_analysis/decision_matrix.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/asv_mmg_distribution.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/asv_mmg_distribution.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/asv_mmg_bubble.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/asv_mmg_bubble.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/mmg_read_distribution.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/mmg_read_distribution.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/mmg_pattern_matrix.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/mmg_pattern_matrix.json
2025-04-24 10:52:19 - INFO - Saved HTML plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/mmg_sankey_flow.html
2025-04-24 10:52:19 - INFO - Saved JSON plot: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/visualizations/asv_mmg_analysis/mmg_sankey_flow.json
2025-04-24 10:52:19 - INFO - Results saved to: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425
2025-04-24 10:52:20 - INFO - Generated enhanced HTML report: /Users/sarawut/Library/CloudStorage/OneDrive-ImperialCollegeLondon/2024_R/R_analysis/Chapter2_Data_generation/Barcoding_Machine_Learning/Barcoding_Machine_Learning_OR_200425/reports/analysis_report.html
