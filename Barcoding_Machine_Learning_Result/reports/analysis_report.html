
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>ASV Selection Analysis Report</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
            <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
            <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
            <style>
                body {
                    margin: 0;
                    padding: 0;
                    background-color: #f8f9fa;
                }
                
                .sidebar {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 280px;
                    height: 100vh;
                    background: #2c3e50;
                    padding: 20px 0;
                    z-index: 1000;
                    overflow-y: auto;
                    color: white;
                }
                
                .content-wrapper {
                    margin-left: 280px;
                    padding: 20px 40px;
                    min-height: 100vh;
                }
                
                .nav-link {
                    color: rgba(255,255,255,0.8);
                    margin: 5px 15px;
                    padding: 10px 15px;
                    border-radius: 5px;
                    transition: all 0.3s;
                    display: flex;
                    align-items: center;
                }
                
                .nav-link i {
                    margin-right: 10px;
                    width: 20px;
                    text-align: center;
                }
                
                .nav-link:hover,
                .nav-link.active {
                    background: #3498db;
                    color: white;
                    transform: translateX(5px);
                }
                
                .section {
                    background: white;
                    margin: 30px 0;
                    padding: 30px;
                    border-radius: 15px;
                    box-shadow: 0 2px 4px rgba(0,0,0,.05);
                }
                
                .section-header {
                    margin-bottom: 25px;
                    padding-bottom: 15px;
                    border-bottom: 2px solid #3498db;
                }
                
                .metric-card {
                    background: linear-gradient(135deg,#2c3e50,#3498db);
                    color: white;
                    padding: 25px;
                    border-radius: 15px;
                    text-align: center;
                    transition: transform 0.3s;
                    height: 100%;
                }
                
                .metric-card:hover {
                    transform: translateY(-5px);
                }
                
                .plot-container {
                    width: 100%;
                    margin: 25px 0;
                    background: white;
                    border-radius: 10px;
                    box-shadow: 0 2px 4px rgba(0,0,0,.05);
                    overflow: visible;
                }
                
                .plot-frame {
                    width: 100%;
                    min-height: 1000px;
                    border: none;
                    overflow: visible;
                }
                
                .summary-section {
                    background: #f8f9fa;
                    padding: 20px;
                    border-radius: 10px;
                    margin-top: 20px;
                }
                
                .summary-card {
                    background: white;
                    padding: 20px;
                    border-radius: 10px;
                    margin-bottom: 20px;
                    box-shadow: 0 2px 4px rgba(0,0,0,.05);
                }
                
                @media print {
                    .sidebar {
                        display: none;
                    }
                    .content-wrapper {
                        margin-left: 0;
                    }
                    .section {
                        break-inside: avoid;
                    }
                }
            </style>
        </head>
        <body>
        
        <div class="sidebar">
            <div class="nav flex-column">
        
                <a class="nav-link" href="#overview">
                    <i class="fas fa-chart-line"></i>Overview
                </a>
            
                <a class="nav-link" href="#model_performance">
                    <i class="fas fa-brain"></i>Model Performance
                </a>
            
                <a class="nav-link" href="#correlation_analysis">
                    <i class="fas fa-project-diagram"></i>Correlation Analysis
                </a>
            
                <a class="nav-link" href="#threshold_analysis">
                    <i class="fas fa-sliders-h"></i>Threshold Analysis
                </a>
            
                <a class="nav-link" href="#feature_analysis">
                    <i class="fas fa-columns"></i>Feature Analysis
                </a>
            
                <a class="nav-link" href="#pca_analysis">
                    <i class="fas fa-cube"></i>PCA Analysis
                </a>
            
                <a class="nav-link" href="#agreement_analysis">
                    <i class="fas fa-handshake"></i>Agreement Analysis
                </a>
            
                <a class="nav-link" href="#taxonomic_analysis">
                    <i class="fas fa-sitemap"></i>Taxonomic Analysis
                </a>
            
                <a class="nav-link" href="#asv_mmg_analysis">
                    <i class="fas fa-dna"></i>ASV-MMG Analysis
                </a>
            
                <a class="nav-link" href="#summary">
                    <i class="fas fa-clipboard-check"></i>Summary
                </a>
            
            </div>
        </div>
        <div class="content-wrapper">
                <div id="overview" class="section">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-line me-2"></i>Overview</h2>
                        <p class="text-muted">Summary of model performance and key metrics</p>
                        <small class="text-muted">Generated on: 2025-04-24 10:52:19</small>
                    </div>
                    <div class="row g-4">
                        <div class="col-md-3">
                            <div class="metric-card">
                                <i class="fas fa-bullseye fa-2x mb-3"></i>
                                <div class="h2">99.80%</div>
                                <div>Model Accuracy</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="metric-card">
                                <i class="fas fa-check-circle fa-2x mb-3"></i>
                                <div class="h2">100.00%</div>
                                <div>Agreement Rate</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="metric-card">
                                <i class="fas fa-database fa-2x mb-3"></i>
                                <div class="h2">63,451</div>
                                <div>Total ASVs</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="metric-card">
                                <i class="fas fa-check fa-2x mb-3"></i>
                                <div class="h2">8,559</div>
                                <div>Selected ASVs</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                        <div id="model_performance" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-brain me-2"></i>Model Performance</h2>
                                <p class="text-muted">Analysis of model performance including ROC curve, feature importance, and confusion matrix</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_importance</h4>
                                <iframe class="plot-frame"
                                        src="plots/model_performance_feature_importance.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">roc_curve</h4>
                                <iframe class="plot-frame"
                                        src="plots/model_performance_roc_curve.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">confusion_matrix</h4>
                                <iframe class="plot-frame"
                                        src="plots/model_performance_confusion_matrix.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                        <div id="correlation_analysis" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-project-diagram me-2"></i>Correlation Analysis</h2>
                                <p class="text-muted">Feature correlation patterns and relationships</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">correlation_matrix</h4>
                                <iframe class="plot-frame"
                                        src="plots/correlation_analysis_correlation_matrix.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_dendrogram</h4>
                                <iframe class="plot-frame"
                                        src="plots/correlation_analysis_feature_dendrogram.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                        <div id="threshold_analysis" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-sliders-h me-2"></i>Threshold Analysis</h2>
                                <p class="text-muted">Selection threshold optimization analysis</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">threshold_optimization</h4>
                                <iframe class="plot-frame"
                                        src="plots/threshold_analysis_threshold_optimization.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                        <div id="feature_analysis" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-columns me-2"></i>Feature Analysis</h2>
                                <p class="text-muted">Detailed analysis of individual features</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_reads</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_reads.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_total_asv_reads</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_total_asv_reads.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_asv_count</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_asv_count.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_percentage_reads</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_percentage_reads.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_read_proportion</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_read_proportion.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_log_reads</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_log_reads.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_read_density</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_read_density.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_is_single_asv</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_is_single_asv.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_is_dominant_asv</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_is_dominant_asv.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_reads_rank</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_reads_rank.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_relative_abundance</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_relative_abundance.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">feature_distribution_is_match</h4>
                                <iframe class="plot-frame"
                                        src="plots/feature_analysis_feature_distribution_is_match.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                        <div id="pca_analysis" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-cube me-2"></i>PCA Analysis</h2>
                                <p class="text-muted">Principal Component Analysis visualization</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">PCA Analysis</h4>
                                <iframe class="plot-frame"
                                        src="plots/pca_analysis_pca_analysis.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                        <div id="agreement_analysis" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-handshake me-2"></i>Agreement Analysis</h2>
                                <p class="text-muted">Analysis of model-expert agreement patterns and distributions</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">agreement_distribution</h4>
                                <iframe class="plot-frame"
                                        src="plots/agreement_analysis_agreement_distribution.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">decision_matrix</h4>
                                <iframe class="plot-frame"
                                        src="plots/agreement_analysis_decision_matrix.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                        <div id="asv_mmg_analysis" class="section">
                            <div class="section-header">
                                <h2><i class="fas fa-dna me-2"></i>ASV-MMG Analysis</h2>
                                <p class="text-muted">Analysis of ASV-MMG relationships and patterns</p>
                            </div>
                            
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">asv_mmg_distribution</h4>
                                <iframe class="plot-frame"
                                        src="plots/asv_mmg_analysis_asv_mmg_distribution.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">asv_mmg_bubble</h4>
                                <iframe class="plot-frame"
                                        src="plots/asv_mmg_analysis_asv_mmg_bubble.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">mmg_read_distribution</h4>
                                <iframe class="plot-frame"
                                        src="plots/asv_mmg_analysis_mmg_read_distribution.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">mmg_pattern_matrix</h4>
                                <iframe class="plot-frame"
                                        src="plots/asv_mmg_analysis_mmg_pattern_matrix.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                            <div class="plot-container">
                                <h4 class="ps-3 pt-3">mmg_sankey_flow</h4>
                                <iframe class="plot-frame"
                                        src="plots/asv_mmg_analysis_mmg_sankey_flow.html"
                                        loading="lazy"
                                        onload="this.style.height = Math.max(1000, this.contentWindow.document.body.scrollHeight + 50) + 'px'">
                                </iframe>
                            </div>
                        
                        </div>
                        
                <div id="summary" class="section">
                    <div class="section-header">
                        <h2><i class="fas fa-clipboard-check me-2"></i>Summary</h2>
                        <p class="text-muted">Overall findings and recommendations</p>
                    </div>
                    
                    <div class="summary-section">
                        <div class="summary-card">
                            <h4>Key Findings</h4>
                            <ul>
                                <li>Model achieved 99.80% accuracy</li>
                                <li>100.00% agreement rate with expert decisions</li>
                                <li>Selected 8,559 ASVs from 63,451 total ASVs</li>
                                <li>Optimal selection threshold determined at 0.330</li>
                                <li>Perfect agreement between model predictions and expert decisions</li>
                            </ul>
                        </div>
                        
                        <div class="summary-card">
                            <h4>Model Performance</h4>
                            <ul>
                                <li>Random Forest model with optimal parameters</li>
                                <li>Cross-validation score: 99.80%</li>
                                <li>Balanced handling of select/unselect cases</li>
                                <li>Robust feature importance analysis</li>
                            </ul>
                        </div>
                        
                        <div class="summary-card">
                            <h4>Recommendations</h4>
                            <ul>
                                <li>Monitor model performance with new data</li>
                                <li>Validate results with domain experts</li>
                                <li>Consider periodic model retraining as new data becomes available</li>
                                <li>Maintain threshold optimization for different datasets</li>
                                <li>Keep track of taxonomic and MMG patterns for validation</li>
                            </ul>
                        </div>
                        
                        <div class="summary-card">
                            <h4>Future Improvements</h4>
                            <ul>
                                <li>Expand feature set for more robust predictions</li>
                                <li>Implement continuous validation pipeline</li>
                                <li>Enhance taxonomic analysis capabilities</li>
                                <li>Develop more advanced MMG matching algorithms</li>
                                <li>Create automated reporting system for regular updates</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
            </div>
            <script>
                // Resize iframes
                function resizeIframe(iframe) {
                    iframe.style.height = 'auto';
                    const newHeight = Math.max(1000, iframe.contentWindow.document.body.scrollHeight + 50);
                    iframe.style.height = newHeight + 'px';
                }

                // Handle document load
                document.addEventListener('DOMContentLoaded', function() {
                    // Handle iframes
                    const iframes = document.querySelectorAll('.plot-frame');
                    iframes.forEach(iframe => {
                        iframe.onload = function() {
                            resizeIframe(this);
                        };
                    });

                    // Handle navigation
                    const navLinks = document.querySelectorAll('.nav-link');
                    const sections = document.querySelectorAll('.section');
                    
                    // Initialize tooltips
                    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                    tooltipTriggerList.map(function (tooltipTriggerEl) {
                        return new bootstrap.Tooltip(tooltipTriggerEl);
                    });
                    
                    // Smooth scrolling for navigation links
                    navLinks.forEach(link => {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            const targetId = this.getAttribute('href');
                            const targetSection = document.querySelector(targetId);
                            if (targetSection) {
                                targetSection.scrollIntoView({
                                    behavior: 'smooth'
                                });
                            }
                        });
                    });

                    // Active navigation highlighting
                    window.addEventListener('scroll', () => {
                        let current = '';
                        sections.forEach(section => {
                            const sectionTop = section.offsetTop - 100;
                            const sectionHeight = section.offsetHeight;
                            
                            if (window.scrollY >= sectionTop && 
                                window.scrollY < sectionTop + sectionHeight) {
                                current = section.getAttribute('id');
                            }
                        });
                        
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href').slice(1) === current) {
                                link.classList.add('active');
                            }
                        });
                    });

                    // Add scroll to top button functionality
                    const scrollButton = document.createElement('button');
                    scrollButton.innerHTML = '<i class="fas fa-arrow-up"></i>';
                    scrollButton.className = 'btn btn-primary position-fixed';
                    scrollButton.style.cssText = `
                        bottom: 20px;
                        right: 20px;
                        display: none;
                        z-index: 1000;
                        width: 40px;
                        height: 40px;
                        border-radius: 20px;
                        padding: 0;
                        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
                    `;
                    document.body.appendChild(scrollButton);

                    window.onscroll = function() {
                        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                            scrollButton.style.display = "block";
                        } else {
                            scrollButton.style.display = "none";
                        }
                    };

                    scrollButton.onclick = function() {
                        window.scrollTo({
                            top: 0,
                            behavior: 'smooth'
                        });
                    };
                });

                // Handle window resize
                window.addEventListener('resize', function() {
                    const iframes = document.querySelectorAll('.plot-frame');
                    iframes.forEach(iframe => {
                        resizeIframe(iframe);
                    });
                });

                // Print optimization
                window.addEventListener('beforeprint', function() {
                    document.body.style.paddingLeft = '0';
                });
                
                window.addEventListener('afterprint', function() {
                    document.body.style.paddingLeft = '280px';
                });

                // Plot responsiveness
                window.addEventListener('resize', function() {
                    document.querySelectorAll('.js-plotly-plot').forEach(plot => {
                        if (plot && plot.id) {
                            Plotly.Plots.resize(plot.id);
                        }
                    });
                });
            </script>
        </body>
        </html>
        